<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vapor Lock Bookmark Builder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group-inline {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        .form-group-inline > div {
            flex: 1;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 14px;
        }
        .depth-field {
            width: auto;
            min-width: 60px;
        }
        .output-container {
            margin-top: 15px;
            margin-bottom: 15px;
            padding: 0px 15px 0px 15px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .output-string {
            font-family: monospace;
            font-size: 18px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
            transition: background-color 0.3s;
            white-space: pre-wrap;
        }
        .output-string.valid {
            background-color: #d4edda;
        }
        .output-string.invalid {
            background-color: #f8d7da;
        }
        .copy-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .copy-button:hover {
            background-color: #45a049;
        }
        .copy-button:active {
            background-color: #3d8b40;
        }
        .copy-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .action-button {
            background-color: #2196F3;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }
        .action-button:hover {
            background-color: #0b7dda;
        }
        .action-button:active {
            background-color: #0a6bc0;
        }
        .action-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .remove-button {
            background-color: #f44336;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }
        .remove-button:hover {
            background-color: #da190b;
        }
        .remove-button:active {
            background-color: #c0150a;
        }
        .remove-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .copied-message {
            display: none;
            color: #4CAF50;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="form-group form-group-inline">
        <div>
            <label for="currentHole">Current Hole:</label>
            <select id="currentHole">
                <option value="*" selected>Home (J113508)</option>
            </select>
        </div>
        <button id="makeHomeButton" class="action-button" onclick="makeHome()">Make Home</button>
    </div>

    <div id="nextHoleGroup" class="form-group form-group-inline">
        <div>
            <label for="nextHole">Next Hole:</label>
            <select id="nextHole">
                <option value="">Select...</option>
            </select>
        </div>
        <button id="makeCurrentButton" class="action-button" onclick="makeCurrentFromNext()">Make Current</button>
    </div>

    <div id="currentDepthGroup" class="form-group">
        <label for="currentDepth">Current Depth:</label>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
            <div id="depthContainer" style="display: flex; gap: 10px; flex-wrap: wrap;">
                <select id="currentDepth" class="depth-field">
                </select>
            </div>
            <button id="addDepthButton" class="action-button" onclick="addDepth()">Add Depth</button>
            <button id="removeDepthButton" class="remove-button" onclick="removeDepth()">Remove Depth</button>
        </div>
    </div>

    <div class="output-container">
        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
            Temporary Name:
            <div class="output-string" id="temporaryNameCurrent" style="flex: 1;"></div>
            <button id="compytemporaryNameCurrent" class="copy-button" onclick="copytemporaryNameCurrentToClipboard()">Copy to Clipboard</button>
        </div>
        <div class="copied-message" id="copiedtemporaryNameCurrentMessage">Copied!</div>
    </div>

    <div id="nextDepthGroup" class="form-group form-group-inline">
        <div>
            <label for="nextDepth">Next Depth:</label>
            <select id="nextDepth">
            </select>
        </div>
        <button class="action-button" onclick="goToNext()">Next</button>
        <button class="remove-button" onclick="resetDepth()">Reset</button>
    </div>

    <div class="output-container" id="temporaryNameNextContainer">
        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
            Temporary Name:
            <div class="output-string" id="temporaryNameNext" style="flex: 1;"></div>
            <button id="compytemporaryNameNext" class="copy-button" onclick="copytemporaryNameNexttToClipboard()">Copy to Clipboard</button>
        </div>
        <div class="copied-message" id="copiedtemporaryNameNextMessage">Copied!</div>
    </div>

    <div class="form-group">
        <label for="signature">Signature:</label>
        <input type="text" id="signature" maxlength="3" placeholder="First 3 letters of cosmic signature...">
    </div>

    <div class="form-group">
        <label for="code">Wormhole Type:</label>
        <select id="code">
            <option value="">Select...</option>
            <option value="C1">C1</option>
            <option value="C2">C2</option>
            <option value="C3">C3</option>
            <option value="C4">C4</option>
            <option value="C5">C5</option>
            <option value="C6">C6</option>
            <option value="C13">C13</option>
            <option value="HS">HS</option>
            <option value="LS">LS</option>
            <option value="NS">NS</option>
            <option value="TC">TC</option>
            <option value="??">Unknown</option>
        </select>
    </div>

    <div class="output-container">
        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
            Bookmark:
            <div class="output-string" id="output" style="flex: 1;"></div>
            <button id="copyButton" class="copy-button" onclick="copyToClipboard()">Copy to Clipboard</button>
        </div>
        <div class="copied-message" id="copiedMessage">Copied!</div>
    </div>

    <script>
        // NATO Alphabet
        const natoAlphabet = [
            'Alpha', 'Bravo', 'Charlie', 'Delta', 'Echo', 'Foxtrot',
            'Golf', 'Hotel', 'India', 'Juliett', 'Kilo', 'Lima',
            'Mike', 'November', 'Oscar', 'Papa', 'Quebec', 'Romeo',
            'Sierra', 'Tango', 'Uniform', 'Victor', 'Whiskey', 'X-ray',
            'Yankee', 'Zulu'
        ];

        const isHome = () => document.getElementById('currentHole').value === '*';

        // Populate Current Hole dropdown
        const currentHoleSelect = document.getElementById('currentHole');
        natoAlphabet.forEach(function(name) {
            const option = document.createElement('option');
            option.value = name;
            option.textContent = name;
            if (name === 'Charlie') {
                option.disabled = true;
            }
            currentHoleSelect.appendChild(option);
        });

        // Populate Next Hole dropdown
        const nextHoleSelect = document.getElementById('nextHole');
        natoAlphabet.forEach(function(name) {
            const option = document.createElement('option');
            option.value = name;
            option.textContent = name;
            if (name === 'Charlie') {
                option.disabled = true;
            }
            nextHoleSelect.appendChild(option);
        });

        // Function to populate depth dropdown based on current hole
        function populateDepthDropdown() {
            const numberSelect = document.getElementById('currentDepth');
            const currentValue = numberSelect.value;

            // Clear existing options
            numberSelect.innerHTML = '';

            if (isHome()) {
                // For Home, only show 0
                const option = document.createElement('option');
                option.value = '0';
                option.textContent = '0';
                numberSelect.appendChild(option);
                numberSelect.value = '0';
            } else {
                // For other holes, show 1-100 and default to 1
                for (let i = 0; i <= 100; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    numberSelect.appendChild(option);
                }
                // If current value was 0 or invalid, set to 1
                if (!currentValue) {
                    numberSelect.value = '1';
                } else {
                    numberSelect.value = currentValue;
                }
            }

            // Update button states based on new depth value
            updateRemoveDepthButton();
        }

        // Function to populate next depth dropdown (1-100)
        function populateNextDepthDropdown() {
            const nextDepthSelect = document.getElementById('nextDepth');

            // Populate 0-100
            for (let i = 1; i <= 100; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                nextDepthSelect.appendChild(option);
            }
            // Default to 1
            nextDepthSelect.value = '1';
        }

        // Initial population (default to Home)
        populateDepthDropdown(true);
        populateNextDepthDropdown();
        updateRemoveDepthButton();

        document.getElementById('signature').addEventListener('input', function(e) {
            this.value = this.value.replace(/[^a-zA-Z]/g, '');
            generateString();
        });

        document.getElementById('currentHole').addEventListener('change', generateString);

        document.getElementById('nextHole').addEventListener('change', function() {
            const currentHole = document.getElementById('currentHole').value;
            const nextHole = document.getElementById('nextHole').value;
            const codeSelect = document.getElementById('code');
            document.getElementById('signature').value = '';
            document.getElementById('code').value = '';

            // Auto-select C3 when Current Hole is Home and Next Hole is Alpha
            if (isHome() && nextHole === 'Alpha') {
                codeSelect.value = 'C3';
            }

            // Auto-select C5 when Current Hole is Home and Next Hole is Bravo
            if (isHome() && nextHole === 'Bravo') {
                codeSelect.value = 'C5';
            }

            generateString();
        });

        document.getElementById('currentDepth').addEventListener('change', function() {
            updateRemoveDepthButton();
            generateString();
        });
        
        document.getElementById('nextDepth').addEventListener('change', generateString);
        document.getElementById('code').addEventListener('change', generateString);

        function generateString() {
            const currentHole = document.getElementById('currentHole').value;
            const currentDepth = document.getElementById('currentDepth').value;
            const nextDepth = document.getElementById('nextDepth').value;
            const nextHole = document.getElementById('nextHole').value;
            const signature = document.getElementById('signature').value;
            const codeSelect = document.getElementById('code');
            const code = codeSelect.value;

            // Show/hide fields based on Current Hole
            const nextHoleGroup = document.getElementById('nextHoleGroup');
            const currentDepthGroup = document.getElementById('currentDepthGroup');
            const nextDepthGroup = document.getElementById('nextDepthGroup');
            const temporaryNameNextContainer = document.getElementById('temporaryNameNextContainer');

            if (isHome()) {
                nextHoleGroup.style.display = 'flex';
                currentDepthGroup.style.display = 'none';
                nextDepthGroup.style.display = 'none';
                temporaryNameNextContainer.style.display = 'none';

                document.getElementById('temporaryNameCurrent').textContent = `${nextHole.toUpperCase() || ' '}`;
            } else {
                nextHoleGroup.style.display = 'none';
                currentDepthGroup.style.display = 'block';
                nextDepthGroup.style.display = 'flex';
                temporaryNameNextContainer.style.display = 'block';

                if (currentDepth === '0') {
                    document.getElementById('temporaryNameCurrent').textContent = `${currentHole.toUpperCase()}`;
                } else {
                    const currentHoleLetter = currentHole ? currentHole.charAt(0) : '';
                    const depthString = getAllDepths().join('');
                    document.getElementById('temporaryNameCurrent').textContent = `${currentHoleLetter}${depthString === currentHole.toUpperCase() ? '' : depthString}`;
                }
            }

            // Enable/disable Make Current button based on Next Hole selection
            const makeCurrentButton = document.getElementById('makeCurrentButton');
            makeCurrentButton.disabled = !nextHole;

            // Enable/disable Make Home button based on Current Hole
            const makeHomeButton = document.getElementById('makeHomeButton');
            makeHomeButton.disabled = isHome();

            // Update depth dropdown based on current hole
            populateDepthDropdown();

            // Update UI based on validation
            const outputBox = document.getElementById('output');
            const copyButton = document.getElementById('copyButton');

            let isBookmarkValid = false;
            if (isHome()) {
                // For Home, require nextHole, signature, and code
                isBookmarkValid = nextHole && signature && code && signature.length === 3;
            } else {
                // For other holes, require currentHole, signature, and code
                isBookmarkValid = currentHole && signature && code && signature.length === 3;
            }

            if (isBookmarkValid) {
                outputBox.classList.remove('invalid');
                outputBox.classList.add('valid');
                copyButton.disabled = false;
            } else {
                outputBox.classList.remove('valid');
                outputBox.classList.add('invalid');
            }

            let result;

            // If current hole is Home, just use next hole's name
            if (isHome()) {
                result = ` ${nextHole || ''} ${signature} ${code}`.toUpperCase();
            } else {
                // Get first letter of current hole
                const currentHoleLetter = currentHole ? currentHole.charAt(0) : '';
                const depthString = getAllDepths().join('');

                // Build the string: space + current hole letter + depths + next depth + space + signature + space + code
                result = ` ${currentHoleLetter}${depthString === '0' ? '' : depthString}-${nextDepth} ${signature} ${code}`.toUpperCase();

                document.getElementById('temporaryNameNext').textContent = `${currentHoleLetter}${depthString === '0' ? '' : depthString}${nextDepth}`;
            }

            // Update output
            document.getElementById('output').textContent = result;
        }

        let depthCounter = 1;

        function addDepth() {
            const depthContainer = document.getElementById('depthContainer');
            const newSelect = document.createElement('select');
            newSelect.className = 'depth-field';
            newSelect.id = 'currentDepth' + depthCounter;

            // Populate with 1-100
            for (let i = 1; i <= 100; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                newSelect.appendChild(option);
            }
            newSelect.value = '1';

            // Add event listener
            newSelect.addEventListener('change', generateString);

            depthContainer.appendChild(newSelect);
            depthCounter++;
            updateRemoveDepthButton();
            generateString();
        }

        function removeDepth() {
            const depthContainer = document.getElementById('depthContainer');
            const depthFields = depthContainer.querySelectorAll('.depth-field');

            // Only remove if there's more than one depth field
            if (depthFields.length > 1) {
                // Remove the last depth field
                depthFields[depthFields.length - 1].remove();
                updateRemoveDepthButton();
                generateString();
            }
        }

        function updateRemoveDepthButton() {
            const depthContainer = document.getElementById('depthContainer');
            const depthFields = depthContainer.querySelectorAll('.depth-field');
            const removeButton = document.getElementById('removeDepthButton');
            const addButton = document.getElementById('addDepthButton');

            // Disable remove button if only one depth field left
            removeButton.disabled = depthFields.length <= 1;

            // Disable add button if current depth is 0
            const currentDepth = document.getElementById('currentDepth');
            addButton.disabled = currentDepth && currentDepth.value === '0';
        }

        function getAllDepths() {
            const depthFields = document.querySelectorAll('.depth-field');
            const depths = [];
            depthFields.forEach(field => {
                const value = field.value;
                if (value) {
                    depths.push(value);
                }
            });
            return depths;
        }

        function clearExtraDepths() {
            const depthContainer = document.getElementById('depthContainer');
            const depthFields = depthContainer.querySelectorAll('.depth-field');
            // Remove all but the first depth field
            for (let i = 1; i < depthFields.length; i++) {
                depthFields[i].remove();
            }
            depthCounter = 1;
            updateRemoveDepthButton();
        }

        function makeCurrentFromNext() {
            const nextHole = document.getElementById('nextHole').value;
            if (nextHole) {
                document.getElementById('currentHole').value = nextHole;
                document.getElementById('signature').value = '';
                document.getElementById('code').value = '';
                clearExtraDepths();
                generateString();
            }
        }

        function makeHome() {
            document.getElementById('currentHole').value = '*';
            document.getElementById('nextHole').value = '';
            document.getElementById('signature').value = '';
            document.getElementById('code').value = '';
            clearExtraDepths();
            generateString();
        }

        function goToNext() {
            const nextDepthSelect = document.getElementById('nextDepth');
            const currentNextDepth = parseInt(nextDepthSelect.value) || 0;
            const newDepth = currentNextDepth + 1;

            if (newDepth <= 100) {
                nextDepthSelect.value = newDepth.toString();
            }

            document.getElementById('signature').value = '';

            generateString();
        }

        function resetDepth() {
            const nextDepthSelect = document.getElementById('nextDepth');
            nextDepthSelect.value = '1';
            generateString();
        }

        function copyToClipboard() {
            const outputText = document.getElementById('output').textContent;
            navigator.clipboard.writeText(outputText).then(function() {
                const message = document.getElementById('copiedMessage');
                message.style.display = 'block';
                setTimeout(function() {
                    message.style.display = 'none';
                }, 2000);
            }).catch(function(err) {
                alert('Failed to copy: ' + err);
            });
        }

        function copytemporaryNameCurrentToClipboard() {
            const temporaryNameCurrentText = document.getElementById('temporaryNameCurrent').textContent;
            navigator.clipboard.writeText(temporaryNameCurrentText).then(function() {
                const message = document.getElementById('copiedtemporaryNameCurrentMessage');
                message.style.display = 'block';
                setTimeout(function() {
                    message.style.display = 'none';
                }, 2000);
            }).catch(function(err) {
                alert('Failed to copy: ' + err);
            });
        }

        function copytemporaryNameNextToClipboard() {
            consttemporaryNameNextText = document.getElementById('temporaryNameNext').textContent;
            navigator.clipboard.writeText(ttemporaryNameNextText).then(function() {
                const message = document.getElementById('copiedtemporaryNameNexttMessage');
                message.style.display = 'block';
                setTimeout(function() {
                    message.style.display = 'none';
                }, 2000);
            }).catch(function(err) {
                alert('Failed to copy: ' + err);
            });
        }

        // Initialize with empty string
        generateString();
    </script>
</body>
</html>
